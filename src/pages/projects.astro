---
import Layout from "@/layouts/Layout.astro";
import ProjectCard from "@/components/ui/ProjectCard.astro";
import { getCollection } from "astro:content";

// Get all project entries, sorted by order
const projectEntries = await getCollection("projects");
const sortedProjects = projectEntries.sort((a, b) => a.data.order - b.data.order);

// Add ref parameter to project links
const addRef = (url: string) => {
    const separator = url.includes('?') ? '&' : '?';
    return `${url}${separator}ref=beckyschmidt.me`;
};
---

<Layout title="Projects" description="Projects page">
    <div class="mx-auto w-full mt-5 md:mt-10 space-y-10">
        <div class="space-y-6">
            <h1>Projects</h1>
            <p>
                Apps, websites, and experiments I've built to learn, iterate, and try new ideas.
            </p>
            <div class="space-y-6">
                {sortedProjects.map((project) => (
                    <ProjectCard
                        name={project.data.name}
                        tagline={project.data.tagline}
                        link={addRef(project.data.link)}
                    />
                ))}
            </div>
        </div>
    </div>
</Layout>
